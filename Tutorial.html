<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: "Segoe WPC", "Segoe UI", "SFUIText-Light", "HelveticaNeue-Light", sans-serif, "Droid Sans Fallback";
	font-size: 14px;
	padding: 0 12px;
	line-height: 22px;
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}


body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	color: #4080D0;
	text-decoration: none;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

h1 code,
h2 code,
h3 code,
h4 code,
h5 code,
h6 code {
	font-size: inherit;
	line-height: auto;
}

a:hover {
	color: #4080D0;
	text-decoration: underline;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left: 5px solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 14px;
	line-height: 19px;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

.mac code {
	font-size: 12px;
	line-height: 18px;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

/** Theming */

.vscode-light,
.vscode-light pre code {
	color: rgb(30, 30, 30);
}

.vscode-dark,
.vscode-dark pre code {
	color: #DDD;
}

.vscode-high-contrast,
.vscode-high-contrast pre code {
	color: white;
}

.vscode-light code {
	color: #A31515;
}

.vscode-dark code {
	color: #D7BA7D;
}

.vscode-light pre:not(.hljs),
.vscode-light code > div {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre:not(.hljs),
.vscode-dark code > div {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre:not(.hljs),
.vscode-high-contrast code > div {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

.vscode-light blockquote,
.vscode-dark blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.vscode-high-contrast blockquote {
	background: transparent;
	border-color: #fff;
}
</style>

<style>
/*
 * Hopscotch
 * by Jan T. Sott
 * https://github.com/idleberg/Hopscotch
 *
 * This work is licensed under the Creative Commons CC0 1.0 Universal License
 */

/* Comment */
.hljs-comment,
.hljs-quote {
  color: #989498;
}

/* Red */
.hljs-variable,
.hljs-template-variable,
.hljs-attribute,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-link,
.hljs-deletion {
  color: #dd464c;
}

/* Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params {
  color: #fd8b19;
}

/* Yellow */
.hljs-class .hljs-title {
  color: #fdcc59;
}

/* Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
  color: #8fc13e;
}

/* Aqua */
.hljs-meta {
  color: #149b93;
}

/* Blue */
.hljs-function,
.hljs-section,
.hljs-title {
  color: #1290bf;
}

/* Purple */
.hljs-keyword,
.hljs-selector-tag {
  color: #c85e7c;
}

.hljs {
  display: block;
  background: #322931;
  color: #b9b5b8;
  padding: 0.5em;
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}

</style>

<style>
/*
 * Markdown PDF CSS
 */

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #A31515;
	font-size: inherit;
	font-family: inherit;
}

</style>

</head>
<body>
<h1>New Gadget Tutorial</h1>
<h2>Introduction</h2>
<p>In this quick little tutorial, we'll make a flashlight, which you can toggle on and off, as a gadget.</p>
<p>Start by opening up your Lua location</p>
<p>(<code>c:/users/[your-username]/appdata/locallow/CopyBugPaste/Homebrew14/Lua/GadgetLua</code>)</p>
<p>We'll need to make a couple of files to get a fully working gadget.<br>
First create a new lua file, called Flashlight</p>
<p>Then you'll need an &quot;info&quot; file, this is just a text file which will display the info about your gadget.</p>
<p>Your gadget will also need a picture (64x48 pixels is recommended) of the same name.</p>
<p>In the end, you'll end up with 3 files,</p>
<pre class="hljs"><code><div>Flashlight.lua
Flashlight.info
Flashlight.png
</div></code></pre>
<p>And that's enough to have a 100% working gadget.</p>
<h2>Coding Time</h2>
<p>Next we'll insert the basic mechanics into our flashlight tool.<br>
Open up the Flashlight.lua file, and start by creating the functions we'll need</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Flashlight:Start</span><span class="hljs-params">()</span></span>

<span class="hljs-keyword">end</span> 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Flashlight:Update</span><span class="hljs-params">()</span></span>

<span class="hljs-keyword">end</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Flashlight:OnDestroy</span><span class="hljs-params">()</span></span>

<span class="hljs-keyword">end</span>
</div></code></pre>
<p>every script in Homebrew will follow this syntax, <code>function filename:functionName</code><br>
and we expose all the default unity monobehaviour voids, like<br>
Start, Update, OnDestroy, etc, for more information you can always check up on the Unity3D page about <a href="https://docs.unity3d.com/ScriptReference/MonoBehaviour.html">Monobehaviours</a></p>
<p>So, what does a flashlight gadget actually need? It needs a key to toggle it on/off, a way to see when the button is pressed, and the light to turn on or off obviously!</p>
<p>So, let's start by getting the key.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Flashlight:Start</span><span class="hljs-params">()</span></span>
    self.useKey = HBU.GetKey(<span class="hljs-string">"UseGadget"</span>)
<span class="hljs-keyword">end</span> 
</div></code></pre>
<p>We use the function HBU.GetKey(string) to return a HBKeybind, we <em>could</em> also use the default <a href="https://docs.unity3d.com/ScriptReference/Input.html">Unity3D Input class</a>, but that will make your gadget keyboard specific.</p>
<p>As you can see the input for HBU.GetKey are the names of your keybinds in Homebrew!<br>
<img src="http://i.imgur.com/hJeDFKr.png"/></p>
<p>Next we'll need to create the light objects, set the correct parents, and set the settings we want.</p>
<p>This is fairly simple if you've ever dabbled into Unity3D</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Flashlight:Start</span><span class="hljs-params">()</span></span>
  self.useKey = HBU.GetKey(<span class="hljs-string">"UseGadget"</span>) 
  <span class="hljs-comment">--Create objects</span>
  self.obj = GameObject(<span class="hljs-string">"FlashlightObj"</span>) <span class="hljs-comment">-- This gives the gameobject we create the name "FlashlightObj"</span>
  self.obj.transform:SetParent(Camera.main.transform) <span class="hljs-comment">--parent it inside the main camera</span>
  self.obj.transform.localPosition = Vector3(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>) <span class="hljs-comment">--set the **localposition** to 0,0,0 (aka relative pos to parent)</span>
  self.obj.transform.localRotation = Quaternion.identity <span class="hljs-comment">--set localrotation to identity (forward)</span>
  self.light = self.obj:AddComponent(<span class="hljs-string">"UnityEngine.Light"</span>) <span class="hljs-comment">--Add a light component, which is under UnityEngine</span>
<span class="hljs-keyword">end</span>
</div></code></pre>
<p>Next we need to make sure the light gets destroyed, when you switch gadgets, so let's do that now before we test our code, (just in-case).</p>
<p>We'll use the OnDestroy function provided by Unity for this.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Flashlight:OnDestroy</span><span class="hljs-params">()</span></span>
    GameObject.Destroy(self.obj)
<span class="hljs-keyword">end</span> 
</div></code></pre>
<p>This makes sure that when we switch our gadgets, the light object gets killed as well, and it won't create more then one when we switch back to the flashlight tool.</p>
<p><strong>Remember to always clean up your objects!</strong></p>
<p>So now you've got a light! But, it's a point light! That's not what we want, we want a spotlight. Since we can't just chug in variable names and expect them to work, it's always a good idea to check the Unity Documentation about the <a href="https://docs.unity3d.com/ScriptReference/Light.html">Component</a> we added.<br>
They always have all the public variables, and functions we'll might need.</p>
<p>So let's change some values on our light component!</p>
<pre class="hljs"><code><div>  self.light.<span class="hljs-built_in">type</span> = LightType.Spot  <span class="hljs-comment">--Defaults to Point light so, change to spot</span>
  self.light.range = <span class="hljs-number">500</span>            <span class="hljs-comment">-- up the range a fair bit</span>
  self.light.intensity = <span class="hljs-number">1.5</span>        <span class="hljs-comment">-- up the intensity a bit</span>
  self.light.spotAngle = <span class="hljs-number">55</span>         <span class="hljs-comment">-- set the angle to a neat 55Â° </span>
</div></code></pre>
<p>We can just chuck those values in Start, right after we create the light.</p>
<p>Now if you try the gadget in Homebrew, you'll see that switching to the flashlight will create the light, and switching to another gadget destroys it.</p>
<p>So let's add the functionality to enable/disable it manually, by pressing your LMB/RT</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Flashlight:Update</span><span class="hljs-params">()</span></span>
  <span class="hljs-keyword">if</span>(self.useKey:GetKeyDown())<span class="hljs-keyword">then</span>
    self.light.enabled = <span class="hljs-keyword">not</span> self.light.enabled <span class="hljs-comment">--turn it on/off if useKey is pressed down </span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</div></code></pre>
<p>And that's it! You can always customize the code a lot further (like changing the colors, range, if it displays shadows or not, etc)</p>
<p>Now we can open up Flashlight.info, and insert the information about our gadget</p>
<p>Something like</p>
<pre class="hljs"><code><div>Press your Gadget key to Toggle the flashlight!
</div></code></pre>
<p>should be sufficient enough for now.</p>

</body>
</html>
